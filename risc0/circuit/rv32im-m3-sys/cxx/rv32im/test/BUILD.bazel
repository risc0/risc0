load("@bazel_skylib//rules:run_binary.bzl", "run_binary")
load("//bazel/toolchain/rv32im-linux:defs.bzl", "risc0_cc_binary", "risc0_cc_kernel_binary")

package(
    default_visibility = ["//visibility:public"],
)

cc_library(
    name = "test_prove",
    srcs = [
        "test_prove.cpp",
    ],
    hdrs = [
        "test_prove.h",
    ],
    deps = [
        "//hal/cpu",
        "//prove",
        "//verify",
    ],
)

risc0_cc_binary(
    name = "guest",
    srcs = ["guest.cpp"],
)

risc0_cc_kernel_binary(
    name = "benchmark_kernel",
    srcs = [
        "benchmark_kernel.cpp",
        "entry.s",
    ],
)

risc0_cc_kernel_binary(
    name = "test_bigint_kernel",
    srcs = [
        "entry.s",
        "test_bigint_kernel.cpp",
    ],
    deps = [
        "//rv32im/base:platform",
    ],
)

risc0_cc_kernel_binary(
    name = "test_io_kernel",
    srcs = [
        "entry.s",
        "test_io_kernel.cpp",
    ],
    deps = [
        "//rv32im/base:platform",
    ],
)

cc_test(
    name = "tune",
    srcs = [
        "tune.cpp",
    ],
    deps = [
        "//rv32im/emu",
    ],
)

cc_test(
    name = "test_kernels",
    srcs = ["test_kernels.cpp"],
    data = [
        ":test_bigint_kernel",
        ":test_io_kernel",
    ],
    deps = ["//rv32im/test:test_prove"],
)
